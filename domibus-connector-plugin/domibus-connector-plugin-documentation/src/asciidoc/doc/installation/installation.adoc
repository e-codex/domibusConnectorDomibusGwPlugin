
:path: ../../

ifndef::basepath[]
:basepath: {path}
endif::basepath[]

ifndef::header[]
include::{basepath}/doc/header.adoc[]
endif::header[]

ifndef::mvnbasedir[]
:mvnbasedir: {basepath}/../../../../../
endif::mvnbasedir[]


= Plugin installation Guide

== Preconditions

* Domibus Gateway setup is complete and domibus is running
* Domibus UI is reachable under $UI-URL
* Domibus is reachable under $DOMIBUS-URL
* Domibus-config folder is located under $DOMIBUS-CONFIG-LOCATION

TIP: Consult the link:https://ec.europa.eu/cefdigital/wiki/download/attachments/352387309/%28eDelivery%29%28AP%29%28AG%29%284.2.1%29%288.6%29.pdf?version=1&modificationDate=1619426922903&api=v2[domibus administration guide] for details

== First Steps

Download the most recent domibusConnectorDomibusPlugin via
link:https://secure.e-codex.eu/nexus/content/groups/public/eu/domibus/connector/plugin/domibus-connector-plugin-Distribution/[]

Extract the downloaded distribution package to any location, this location will
from now on be referenced as $PLUGIN-DISTRIBUTION

Also make sure that you use the installation manual of this specific version.
This installation manual is for version: **{project-version}**.


== Installing the plugin on domibus

The plugin comes packaged as a jar file. This jar file has to be
put into the domibus plugin lib folder, so domibus wil find it
during startup:

[source, bash]
----
cp $PLUGIN-DISTRIBUTION/plugins/lib/domibus-connector-[push|pull]-plugin.jar $DOMIBUS-CONFIG-LOCATION/conf/plugins/lib/domibus-connector-[push|pull]-plugin.jar
----





=== Configuring certificates

TODO: describe locations of certificate stores...link to java key store explorer + key generation tutorial.


=== Configuring the plugin

//Add the following properties to your domibus.properties file:
//
//[source, properties]
//----
//include::{mvnbasedir}/domibus-connector-plugin/src/main/resources/config/dc-plugin-default.properties[lines=1..-1]
//----

Location

**Push-Plugin** Property names

**Pull-Plugin** Property names


TIP: As an alternative the properties can also be put into a file under ${domibus.config.location}/plugins/config/dc-plugin.properties. The plugin will also lookup properties their.
Choose either one of the 2 approaches, otherwise the behaviour is undefined.

WARNING: Please remember to update the properties according to your environment.

=== Pull Plugin Configuration
include::{basepath}/doc/installation/pull-plugin-installation.adoc[leveloffset=+2]

=== Push Plugin Configuration
include::{basepath}/doc/installation/push-plugin-installation.adoc[leveloffset=+2]

== Checks

Restart the domibus GW. Open the domibus UI and login with the admin user. On the left side open the 'Message Filter' there should now be
a **DC_PULL_PLUGIN** and/or **DC_PUSH_PLUGIN** available (depends on copied plugins).

TIP: Consult the link:https://ec.europa.eu/cefdigital/wiki/download/attachments/352387309/%28eDelivery%29%28AP%29%28AG%29%284.2.1%29%288.6%29.pdf?version=1&modificationDate=1619426922903&api=v2[domibus administration guide] (chapter 10.4 Message Filtering) to learn more about message filtering.

.Message Filter View
image:MessageFilterView.png[Message Filter]

Also check if the Plugin is listed under $DOMIBUS-URL/services

.Soap Services overview
image:soap_services.png[Soap Services]

WARNING: Please make sure, that ONLY the MSHWebservice is available from the internet. Otherwise you are exposing internal webservices to the outside world.

include::{basepath}/doc/versioning_and_compatibility/compatibility_matrix.adoc[leveloffset=+2]

include::{basepath}/doc/versioning_and_compatibility/test-matrix.adoc[leveloffset=+2]